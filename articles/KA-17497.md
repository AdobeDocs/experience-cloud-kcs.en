---
title: "Find out which requests does AEM Dispatcher cache"
description: Description
solution: Experience Manager
product: Experience Manager
applies-to: "Experience Manager"
keywords: "KCS"
resolution: Resolution
internal-notes: 
bug: False
article-created-by: Roxann McGlumphy
article-created-date: "12/2/2022 9:08:56 PM"
article-published-by: Nayanika Chakravarty
article-published-date: "3/23/2023 5:12:49 PM"
version-number: 2
article-number: KA-17497
dynamics-url: "https://adobe-ent.crm.dynamics.com/main.aspx?forceUCI=1&pagetype=entityrecord&etn=knowledgearticle&id=0534af84-8572-ed11-9561-6045bd006079"

---
# Find out which requests does AEM Dispatcher cache

## Description {#description}

<br>Issue<br><br>
Need to determine why HTTP request/response is not being cached by the AEM Dispatcher
<br><br>Environment<br><br>
AEM Dispatcher 4.3.3


## Resolution {#resolution}


The documentation covers the most important scenarios that affect the cache-ability of requests and responses which go through the AEM Dispatcher module. All cache rules are not covered.

<b>HTTP Request & Caching Rules</b>

For an HTTP request to be cacheable by the dispatcher, it must adhere to the following rules:

1. URL is absolute (not working with . or ..), has a file extension, and the filename in the URL works as a file on the file system.
    <b>Related log messages:</b>


    ```
    URI not canonical: %s.    
    Unable to map URI to file: %s.    
    cache file path too long    
    temporary file path too long    
    request URL has no extension
    ```



    <b>Examples:</b>


    | `/content/test` | not cached |
    | --- | --- |
    | `/content/test.html` | cached |


2. It has no slashes after the first file extension.<br>

    <b>Related log messages:</b>


    ```
    request URL has trailing slash
    ```



    <b>Examples:</b>


    | `/content/test.html/` | not cached |
    | --- | --- |
    | `/content/test.html/foo.jpg` | not cached |
    | `/content/test.html` | cached |


3. It uses HTTP GET or HEAD method.<br>

    <b>Related log messages:</b>


    ```
    request method is neither GET nor HEAD
    ```



    <b>Examples:</b>


    | `HEAD /content/test.html HTTP/1.1` | cached |
    | --- | --- |
    | `GET /content/dam/test.jpg HTTP/1.1` | not cached |
    | `POST /content/test.html HTTP/1.1` | not cached |


4. The request is denied by /CACHE = /RULES defined in the dispatcher. ANY FARM CONFIGURATION.
    <b>Related log messages:</b>


    ```
    URI not  in cache rules: %s request URL not in cache rules
    ```



    <b>Examples:</b>


    | <br><br>    ```<br>    Farm has /cache = /rules and a request is received for /content/test.html<br>        /cache<br>        {<br>         ...<br>         /rules<br>         {<br>          /0001 {<br>          type "deny"<br>          glob "*"<br>          }<br>         }<br>        }<br>    ```<br><br> | not cached |
    | --- | --- |
    | <br><br>    ```<br>    Farm has /cache = /rules and a request is received for /content/test.html<br>        /cache<br>        {<br>         ...<br>         /rules<br>         {<br>          /0001 {<br>          type "allow"<br>          glob "*"<br>          }<br>         }<br>        }<br>    ```<br><br> | cached |


5. The HTTP request does not contain an authorization header or it contains the header but /ALLOWAUTHORIZED is set to 1 in the FARM CONFIGURATION.
    <b>Related log messages:</b>


    ```
    request contains authorization
    ```



    <b>Examples:</b>


    | HTTP Request:<br><br>    ```<br>    GET /content/test.html HTTP/1.1    Authorization: Basic YWxhZGRpbjpvcGVuc2VzYW1l<br>        dispatcher.any farm /cache = /allowAuthorized configuration:<br>        /cache {<br>           /allowAuthorized “0”    }<br>    ```<br><br> | not cached |
    | --- | --- |
    | HTTP Request:<br><br>    ```<br>    GET /content/test.html HTTP/1.1    Authorization: Basic YWxhZGRpbjpvcGVuc2VzYW1l<br>        dispatcher.any farm /cache = /allowAuthorized configuration:<br>        /cache {<br>           /allowAuthorized “1”    }<br>    ```<br><br> | cached |


6. The HTTP request contains LOGIN-TOKEN or AUTHORIZATION COOKIE in the cookie header or it contains either (or both) of those cookies and /ALLOWAUTHORIZED is set to 1 in the FARM CONFIGURATION.
    <b>Related log messages:</b>


    ```
    request contains authorization
    ```



    <b>Examples:</b>


    | HTTP Request:<br><br>    ```<br>    GET /content/test.html HTTP/1.1    Cookie: login-token=…<br>        dispatcher.any farm /cache = /allowAuthorized configuration:<br>        /cache {<br>           /allowAuthorized “0”    }<br>    ```<br><br> | not cached |
    | --- | --- |
    | HTTP Request:<br><br>    ```<br>    GET /content/test.html HTTP/1.1    Cookie: authorization=YWxhZGRpbjpvcGVuc2VzYW1l<br>        dispatcher.any farm /cache = /allowAuthorized configuration:<br>        /cache {<br>           /allowAuthorized “0”    }<br>    ```<br><br> | not cached |
    | HTTP Request:<br><br>    ```<br>    GET /content/test.html HTTP/1.1    Cookie: login-token=…<br>        dispatcher.any farm /cache = /allowAuthorized configuration:<br>        /cache {<br>           /allowAuthorized “1”    }<br>    ```<br><br> | cached |


7. There's a QUERYSTRING parameter in the URL and the parameter is allowed to be ignored via the FARM’S /IGNOREURLPARAMS CONFIGURATION.
    <b>Related log messages:</b>


    ```
    request contains a query string
    ```



    <b>Examples:</b>


    | HTTP Request:<br><br>    ```<br>    GET /content/test.html?test=1 HTTP/1.1    Farm /cache configuration:<br>        /ignoreUrlParams {     /0001 { /type “allow” /glob “*” }    }<br>    ```<br><br> | cached |
    | --- | --- |
    | HTTP Request:<br><br>    ```<br>    GET /content/test.html?test=1 HTTP/1.1    Farm /cache configuration:<br>        /ignoreUrlParams {     /0001 { /type “deny” /glob “*” } <br>           /0001 { /type “allow” /glob “test” }    }<br>    ```<br><br> | cached |
    | HTTP Request:<br><br>    ```<br>    GET /content/test.html?test=1 HTTP/1.1    dispatcher.any farm /cache = /allowAuthorized configuration:<br>        /ignoreUrlParams {<br>         /0001 { /type “deny” /glob “*” } <br>           /0001 { /type “allow” /glob “q” }    }<br>    ```<br><br> | not cached |



<b>HTTP Response & Caching Rules:</b>

The HTTP response returned from AEM is cacheable if the following criteria are met:

1. The dispatcher is able to send and receive a 200 OK response from one of the defined “RENDERS”.

     <b>Note:</b> If no [/timeout](https://experienceleague.adobe.com/docs/experience-manager-dispatcher/using/configuring/dispatcher-configuration.html?lang=en) is set on the /renders or it is set to 0 then it would wait forever for a connection to the AEM instance even if the instance is down.
    <b>Related log messages:</b>


    ```
    Unable to send request to remote server. Unable to receive response from remote server. Remote server returned: %s No backend available.
    ```



    <b>Examples:</b>


    | HTTP Request:<br><br>    200 OK | cached |
    | --- | --- |
    | HTTP Request:<br><br>    404 Page Not Found | not cached |


2. None of these response headers are present in the response:

    - `Dispatcher: no-cache`
    - `Cache-control: no-cache`
    - `Pragma: no-cache`



    <b>Related log messages:</b>


    ```
    Backend forbids caching: %s, sent: %s" response contains no_cache
    ```



    <b>Examples:</b>


    | HTTP Response:<br><br>    200 OK<br><br>    Dispatcher: no-cache | not cached |
    | --- | --- |
    | HTTP Response:<br>    <br><br>    200 OK<br><br>    Cache-control: no-cache | not cached |
    | HTTP Response:<br><br>    200 OK<br><br>    Pragma: no-cache | not cached |
    | HTTP Response:<br><br>    200 OK<br>     | cached |


3. Content-length value is greater than ZERO BYTES.
    <b>Related log messages:</b>


    ```
    response content length is zero
    ```



    <b>Examples:</b>


    | HTTP Response:<br><br>    200 OK<br><br>    Content-Length: 0 | not cached |
    | --- | --- |
    | HTTP Response:<br><br>    200 OK<br><br>    Content-Length: 3120 | cached |


