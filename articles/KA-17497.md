---
title: "Find out which requests does AEM Dispatcher cache"
description: Description
solution: Experience Manager
product: Experience Manager
applies-to: "Experience Manager"
keywords: "KCS"
resolution: Resolution
internal-notes: 
bug: False
article-created-by: Roxann McGlumphy
article-created-date: "12/2/2022 9:08:56 PM"
article-published-by: Roxann McGlumphy
article-published-date: "12/2/2022 9:28:47 PM"
version-number: 2
article-number: KA-17497
dynamics-url: "https://adobe-ent.crm.dynamics.com/main.aspx?forceUCI=1&pagetype=entityrecord&etn=knowledgearticle&id=0534af84-8572-ed11-9561-6045bd006079"

---
# Find out which requests does AEM Dispatcher cache

## Description {#description}

<br>Issue<br><br>
Need to determine why HTTP request/response is not being cached by the AEM Dispatcher
<br><br>Environment<br><br>
AEM Dispatcher 4.3.3


## Resolution {#resolution}


The documentation covers the most important scenarios that affect the cache-ability of requests and responses which go through the AEM Dispatcher module. All cache rules are not covered.
<br>HTTP Request & Caching Rules<br>
For an HTTP request to be cacheable by the dispatcher, it must adhere to the following rules.
<br>1. URL IS ABSOLUTE (NOT STARTING WITH . OR ..), HAS A FILE EXTENSION, AND THE FILENAME IN THE URL WORKS AS A FILE ON THE FILE SYSTEM.<br>
<b>Related log messages:</b>


| `URI not canonical: %s.``Unable to map URI to ``file``: %s.``cache ``file` `path too long``temporary ``file` `path too long``request URL has no extension` |
| --- |


<b>Examples:</b>


| /content/test | not cached |
| --- | --- |
| /content/test.html | cached |

<br>2. IT HAS NO SLASHES AFTER THE FIRST FILE EXTENSION.<br>
<b>Related log messages:</b>


| `request URL has trailing slash` |
| --- |


<b>Examples:</b>


| /content/test.html/ | not cached |
| --- | --- |
| /content/test.html/foo.jpg | not cached |
| /content/test.html | cached |

<br>3. IT USES HTTP GET OR HEAD METHOD.<br>
<b>Related log messages:</b>


| `request method is neither GET nor HEAD` |
| --- |


<b>Examples:</b>


| HEAD /content/test.html HTTP/1.1 | cached |
| --- | --- |
| GET /content/dam/test.jpg HTTP/1.1 | not cached |
| POST /content/test.html HTTP/1.1 | not cached |



4. THE REQUEST IS DENIED BY /CACHE = /RULES DEFINED IN THE DISPATCHER .ANY FARM CONFIGURATION


<b>Related log messages:</b>


| `URI not ``in` `cache rules: %s``request URL not ``in` `cache rules` |
| --- |


<b>Examples:</b>


| Farm has /cache = /rules and a request is received for <b>/content/test.html</b><br><br><b>/cache</b><br><br><b>{</b><br><br><b>  ...</b><br><br><b>  /rules</b><br><br><b>  {</b><br><br><b>    /0001 {</b><br><br><b>      type "deny"</b><br><br><b>      glob "\*"</b><br><br><b>  }</b><br><br><b>}</b> | not cached |
| --- | --- |
| Farm has /cache = /rules and a request is received for <b>/content/test.html</b><br><br><b>/cache</b><br><br><b>{</b><br><br><b>  ...</b><br><br><b>  /rules</b><br><br><b>  {</b><br><br><b>    /0001 {</b><br><br><b>      type "allow"</b><br><br><b>      glob "\*"</b><br><br><b>  }</b><br><br><b>}</b> | cached |

<br>5. THE HTTP REQUEST DOES NOT CONTAIN AN AUTHORIZATION HEADER, OR IT CONTAINS THE HEADER BUT /ALLOWAUTHORIZED IS SET TO 1 IN THE FARM CONFIGURATION<br>
<b>Related log messages:</b>


| `request contains authorization` |
| --- |




<b>Examples:</b>




| HTTP Request:<br><br><b>GET /content/test.html HTTP/1.1<br>Authorization: Basic YWxhZGRpbjpvcGVuc2VzYW1l</b><br><br>dispatcher.any farm /cache = /allowAuthorized configuration:<br><br><b>/cache {<br>  /allowAuthorized "0"<br>}</b> | not cached |
| --- | --- |
| HTTP Request:<br><br><b>GET /content/test.html HTTP/1.1<br>Authorization: Basic YWxhZGRpbjpvcGVuc2VzYW1l</b><br><br>dispatcher.any farm /cache = /allowAuthorized configuration:<br><br><b>/cache {<br>  /allowAuthorized "1"<br>}</b> | cached |



6. THE HTTP REQUEST CONTAINS LOGIN-TOKEN OR AUTHORIZATION COOKIE IN THE COOKIE HEADER, OR IT CONTAINS EITHER (OR BOTH) OF THOSE COOKIES AND /ALLOWAUTHORIZED IS SET TO 1 IN THE FARM CONFIGURATION


<b>Related log messages:</b>


| `request contains authorization` |
| --- |


<b>Examples:</b>


| HTTP Request:<br><br><b>GET /content/test.html HTTP/1.1<br>Cookie: login-token=...</b><br><br>dispatcher.any farm /cache = /allowAuthorized configuration:<br><br><b>/cache {<br>  /allowAuthorized "0"<br>}</b> | not cached |
| --- | --- |
| HTTP Request:<br><br><b>GET /content/test.html HTTP/1.1<br>Cookie: authorization=YWxhZGRpbjpvcGVuc2VzYW1l</b><br><br>dispatcher.any farm /cache = /allowAuthorized configuration:<br><br><b>/cache {<br>  /allowAuthorized "0"<br>}</b> | not cached |
| HTTP Request:<br><br><b>GET /content/test.html HTTP/1.1<br>Cookie: login-token=...</b><br><br>dispatcher.any farm /cache = /allowAuthorized configuration:<br><br><b>/cache {<br>  /allowAuthorized "1"<br>}</b> | cached |



7. THERE'S A QUERYSTRING PARAMETER IN THE URL AND THE PARAMETER IS ALLOWED TO BE IGNORED VIA THE FARM'S /IGNOREURLPARAMS CONFIGURATION


<b>Related log messages:</b>


| `request contains a query string` |
| --- |


<b>Examples:</b>


| HTTP Request:<br><br><b>GET /content/test.html?test=1 HTTP/1.1</b><br><br>Farm /cache configuration:<br><br><b>/ignoreUrlParams {<br>   /0001 { /type "allow" /glob "\*" } <br>}</b> | cached |
| --- | --- |
| HTTP Request:<br><br><b>GET /content/test.html?test=1 HTTP/1.1</b><br><br>Farm /cache configuration:<br><br>/ignoreUrlParams {<br>   /0001 { /type "deny" /glob "\*" } <br>   /0001 { /type "allow" /glob "test" }<br>} | cached |
| HTTP Request:<br><br><b>GET /content/test.html?test=1 HTTP/1.1</b><br><br>dispatcher.any farm /cache = /allowAuthorized configuration:<br><br><b>/ignoreUrlParams {<br>   /0001 { /type "deny" /glob "\*" } <br>   /0001 { /type "allow" /glob "q" }<br>}</b> | not cached |



HTTP Response & Caching Rules:


The HTTP response returned from AEM is cacheable if the following criteria are met.
<br>1. THE DISPATCHER IS ABLE TO SEND AND RECEIVE A 200 OK RESPONSE FROM ONE OF THE DEFINED "RENDERS"<br>
Note:

If no [/timeout](https://helpx.adobe.com/experience-manager/dispatcher/using/dispatcher-configuration.html#DefiningPageRenderersrenders) is set on the /renders or it is set to <b>0</b> then it would wait forever for a connection to the AEM instance even if the instance is down.

<b>Related log messages:</b>


| `Unable to send request to remote server.``Unable to receive response from remote server.``Remote server returned: %s``No backend available.` |
| --- |


<b>Examples:</b>


| HTTP Request:<br><br><b>200 OK</b> | cached |
| --- | --- |
| HTTP Request:<br><br><b>404 Page Not Found</b> | not cached |



2. NONE OF THESE RESPONSE HEADERS ARE PRESENT IN THE RESPONSE:


- <b>Dispatcher: no-cache</b>
- <b>Cache-control: no-cache</b>
- <b>Pragma: no-cache</b>


<b>Related log message:</b>


| `Backend forbids caching: %s, sent: %s"``response contains no_cache` |
| --- |


<b>Examples:</b>


| HTTP Response:<br><br><b>200 OK<br>Dispatcher: no-cache</b> | not cached |
| --- | --- |
| HTTP Response:<br><br><b>200 OK<br>Cache-control: no-cache</b> | not cached |
| HTTP Response:<br><br><b>200 OK<br>Pragma: no-cache</b> | not cached |
| HTTP Response:<br><br><b>200 OK</b> | cached |



3. CONTENT-LENGTH VALUE IS GREATER THAN ZERO BYTES


<b>Related log message:</b>


| `response content length is zero` |
| --- |


<b>Examples:</b>


| HTTP Response:<br><br><b>200 OK<br>Content-Length: 0</b> | not cached |
| --- | --- |
| HTTP Response:<br><br><b>200 OK<br>Content-Length: 3120</b> | cached |

